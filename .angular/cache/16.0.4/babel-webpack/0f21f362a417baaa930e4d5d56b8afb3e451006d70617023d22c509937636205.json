{"ast":null,"code":"// Services\nimport { PhonebookApiService } from '../_services/phonebook-api.service';\nimport { SearchService } from '../_services/search.service';\nimport { LoaderService } from '../_services/loader.service';\n// Entities\n// import { CacheItem } from '../_entities/cacheItem';\nimport { CacheStore } from '../cache-store';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../_services/phonebook-api.service\";\nimport * as i2 from \"../_services/search.service\";\nimport * as i3 from \"../_services/loader.service\";\nfunction TableComponent_span_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"span\", 10);\n  }\n}\nfunction TableComponent_ng_template_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 11);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const col_r3 = ctx.$implicit;\n    i0.ɵɵpropertyInterpolate(\"sortable-column\", col_r3);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", col_r3, \" \");\n  }\n}\nfunction TableComponent_tr_15_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\")(4, \"strong\");\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(6, \"td\");\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"td\");\n    i0.ɵɵtext(9);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"td\");\n    i0.ɵɵtext(11);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const pbItem_r4 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(pbItem_r4.id);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(pbItem_r4.postId);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(pbItem_r4.name);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(pbItem_r4.email);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(pbItem_r4.body);\n  }\n}\nexport let TableComponent = /*#__PURE__*/(() => {\n  class TableComponent {\n    constructor(pbApiService, searchService, loaderService) {\n      this.pbApiService = pbApiService;\n      this.searchService = searchService;\n      this.loaderService = loaderService;\n      this.noResultsTextDefault = 'no data to display';\n      this.maxCachedItems = 5; // Holds the max number of last results to cache\n      this.expirationSecondsForItem = 10; // Holds the number of seconds to expire a cached item.\n      this.cacheStore = new CacheStore(this.maxCachedItems, this.expirationSecondsForItem);\n    }\n    ngOnInit() {\n      this.noResultsText = this.noResultsTextDefault;\n      this.columns = this.pbApiService.getColumns();\n      this.loaderService.status.subscribe(val => {\n        this.showLoader = val;\n      });\n      this.searchService.currentMessage.subscribe(message => {\n        this.inputText = message;\n        if (!this.inputText) {\n          // No input text.\n          this.phonebook = [];\n          this.noResultsText = this.noResultsTextDefault;\n        } else {\n          // Input text was entered.\n          this.loaderService.display(true);\n          const doneCallback = data => {\n            this.phonebook = data;\n            this.loaderService.display(false);\n          };\n          this.cacheStore.GetOrCache(message, callback => {\n            this.pbApiService.getPhonebook(message).subscribe(data => {\n              if (data.length === 0) {\n                this.noResultsText = 'Sorry but there\\'s ' + this.noResultsTextDefault + ' for:';\n              }\n              doneCallback(data);\n              callback(data);\n            });\n          }, doneCallback);\n        }\n      });\n    }\n    onSorted($event) {\n      this.phonebook = this.pbApiService.sortPhonebook(this.phonebook, $event);\n    }\n  }\n  TableComponent.ɵfac = function TableComponent_Factory(t) {\n    return new (t || TableComponent)(i0.ɵɵdirectiveInject(i1.PhonebookApiService), i0.ɵɵdirectiveInject(i2.SearchService), i0.ɵɵdirectiveInject(i3.LoaderService));\n  };\n  TableComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: TableComponent,\n    selectors: [[\"app-table\"]],\n    decls: 16,\n    vars: 7,\n    consts: [[1, \"table-results\"], [1, \"counter\", \"pull-right\"], [\"class\", \"loader\", 4, \"ngIf\"], [\"sortable-table\", \"\", 1, \"table\", \"table-hover\", \"table-bordered\", \"results\", 3, \"sorted\"], [\"ngFor\", \"\", 3, \"ngForOf\"], [1, \"warning\", \"no-result\", 3, \"hidden\"], [\"colspan\", \"5\"], [1, \"fa\", \"fa-warning\"], [3, \"hidden\"], [4, \"ngFor\", \"ngForOf\"], [1, \"loader\"], [3, \"sortable-column\"]],\n    template: function TableComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0);\n        i0.ɵɵelement(1, \"span\", 1);\n        i0.ɵɵtemplate(2, TableComponent_span_2_Template, 1, 0, \"span\", 2);\n        i0.ɵɵelementStart(3, \"table\", 3);\n        i0.ɵɵlistener(\"sorted\", function TableComponent_Template_table_sorted_3_listener($event) {\n          return ctx.onSorted($event);\n        });\n        i0.ɵɵelementStart(4, \"thead\")(5, \"tr\");\n        i0.ɵɵtemplate(6, TableComponent_ng_template_6_Template, 2, 2, \"ng-template\", 4);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(7, \"tr\", 5)(8, \"td\", 6);\n        i0.ɵɵelement(9, \"i\", 7);\n        i0.ɵɵtext(10);\n        i0.ɵɵelementStart(11, \"strong\");\n        i0.ɵɵtext(12);\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(13, \" \\uD83D\\uDE1E\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(14, \"tbody\", 8);\n        i0.ɵɵtemplate(15, TableComponent_tr_15_Template, 12, 5, \"tr\", 9);\n        i0.ɵɵelementEnd()()();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngIf\", ctx.showLoader);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngForOf\", ctx.columns);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"hidden\", ctx.phonebook.length > 0 || ctx.showLoader);\n        i0.ɵɵadvance(3);\n        i0.ɵɵtextInterpolate1(\" \", ctx.noResultsText, \" \");\n        i0.ɵɵadvance(2);\n        i0.ɵɵtextInterpolate(ctx.inputText);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"hidden\", !ctx.phonebook);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngForOf\", ctx.phonebook);\n      }\n    },\n    styles: [\".table-results[_ngcontent-%COMP%]{position:relative}table[_ngcontent-%COMP%]{-webkit-touch-callout:none;-webkit-user-select:none;user-select:none}\"]\n  });\n  return TableComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}